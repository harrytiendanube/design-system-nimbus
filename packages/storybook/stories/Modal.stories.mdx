import { Meta, Story, Props, Preview } from "@storybook/addon-docs/blocks";
import { withKnobs, text, boolean } from "@storybook/addon-knobs";
import { action } from "@storybook/addon-actions";
import { withA11y } from "@storybook/addon-a11y";
import { Modal, Select, Button, Alert } from "@tiendanube/components/src";
import { SlidersIcon } from "@tiendanube/icons";
import { STATUS_ORDER, SHIPPING_METHOD } from "./utils/constants";

import "../utils/style.css";

<Meta title="Components/Modal" component={Modal} />

# Modal

TODO: complete

<Preview>
  <Story name="default" parameters={{ decorators: [withKnobs, withA11y] }}>
    <Modal
      title="Filter by"
      show={boolean("show", false)}
      onDismiss={action("onDismiss")}
      primaryActionLabel="Filter Orders"
      onClickPrimary={action("onClickPrimary")}
      secondaryActionLabel="Clear filters"
      onClickSecondary={action("onClickSecondary")}
    >
      <Select
        label={text("label", "Order Status")}
        name={text("name", "status")}
        options={STATUS_ORDER}
        onChange={action("onChange")}
      />
      <Select
        label={text("label 2", "Shipping method")}
        name={text("name", "shipping")}
        options={SHIPPING_METHOD}
        onChange={action("onChange")}
      />
    </Modal>
  </Story>
</Preview>

## Properties

<Props of={Modal.type} />

# Test

<Preview>
  <Story name="test" parameters={{ decorators: [withKnobs, withA11y] }}>
    {() => {
      const initialState = { status: "Value 1", shipping: "Value 2" };
      const [filter, setFilter] = React.useState(false);
      const [show, setShow] = React.useState(false);
      const [value, setValue] = React.useState(initialState);
      const handleChange = (e) => {
        setValue({ ...value, [e.name]: e.value });
      };
      const handleSecondary = () => {
        setValue(initialState);
      };
      const handlePrimary = () => {
        setFilter(true);
        setShow(false);
      };
      const handleDismiss = () => {
        setFilter(false);
        setShow(false);
      };
      return (
        <div>
          <Button
            appearance="primary"
            icon={SlidersIcon}
            iconPosition="end"
            onClick={() => setShow(true)}
          >
            Filters
          </Button>
          {!show && (
            <div>
              <Alert show={filter}>
                Filter order: {value.status} shipping: {value.shipping}
              </Alert>
            </div>
          )}
          <Modal
            title="Filter by"
            show={show}
            onDismiss={handleDismiss}
            primaryActionLabel="Filter Orders"
            onClickPrimary={handlePrimary}
            secondaryActionLabel="Clear filters"
            onClickSecondary={handleSecondary}
          >
            <Select
              label="Order Status"
              name="status"
              value={value.status}
              options={STATUS_ORDER}
              onChange={handleChange}
            />
            <Select
              label="Shipping method"
              name="shipping"
              value={value.shipping}
              options={SHIPPING_METHOD}
              onChange={handleChange}
            />
          </Modal>
        </div>
      );
    }}
  </Story>
</Preview>
